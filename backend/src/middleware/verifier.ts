import type { RequestHandler } from 'express';import jwt from 'jsonwebtoken';import type { User } from '@prisma/client';function isJwtUser(x: unknown): x is User & jwt.JwtPayload {  return !!x && typeof x === "object" && "active" in x && "id" in x;}export const verifyMiddleware: RequestHandler = async (req, res, next) => {  //gets authorization header  const authHeader = req.headers['authorization'];  const header = authHeader && authHeader.split(' ');  if (!header || header.length != 2 || header[0] != 'Bearer') {    next();    return;  }  //uses jwt to verify if the token is valid  const token = header[1];  jwt.verify(token!, process.env.JWT_SECRET!, (err, user) => {    if (!err && isJwtUser(user) && user.active) req.user = user;    next();  });};